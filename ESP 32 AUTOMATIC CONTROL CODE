#define PARKING_SENSOR_PIN 2
#define PARKING_RELAY_PIN 3

const unsigned long delayDuration = 5000; // 5 seconds
unsigned long parkingTimer = 0;
bool parkingRelayOn = false;

void setup() {
  pinMode(PARKING_SENSOR_PIN, INPUT);
  pinMode(PARKING_RELAY_PIN, OUTPUT);

  digitalWrite(PARKING_RELAY_PIN, HIGH); // Relay OFF

  Serial.begin(9600);
}

void loop() {
  unsigned long currentTime = millis();

  // Parking Unit
  int parkingSensor = digitalRead(PARKING_SENSOR_PIN);
  if (parkingSensor == HIGH) {
    if (!parkingRelayOn) {
      Serial.println("Parking motion detected! Light ON.");
    }
    digitalWrite(PARKING_RELAY_PIN, LOW);
    parkingTimer = currentTime;
    parkingRelayOn = true;
  }

  if (parkingRelayOn) {
    unsigned long elapsedParking = (currentTime - parkingTimer) / 1000;
    Serial.print("Parking time since last motion: ");
    Serial.print(elapsedParking);
    Serial.println(" seconds");

    if ((currentTime - parkingTimer) > delayDuration) {
      digitalWrite(PARKING_RELAY_PIN, HIGH);   
      Serial.println("Parking: No motion for 5 seconds. Light OFF.");
      parkingRelayOn = false;
    }
  }

  delay(1000); // Update every second
}
